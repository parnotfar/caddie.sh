#!/bin/bash

# Caddie Debug Data Structure
# This file manages the global CADDIE_DEBUG flag and provides methods for debug control

# Global debug flag (0 = off, 1 = on)
CADDIE_DEBUG=0

# Set debug mode on (1)
function caddie_debug_on() {
    CADDIE_DEBUG=1
    export CADDIE_DEBUG
}

# Set debug mode off (0)
function caddie_debug_off() {
    CADDIE_DEBUG=0
    export CADDIE_DEBUG
}

# Toggle debug mode
function caddie_debug_toggle() {
    if [ "$CADDIE_DEBUG" -eq 1 ]; then
        caddie_debug_off
    else
        caddie_debug_on
    fi
}

# Get current debug status
function caddie_debug_status() {
    if [ "$CADDIE_DEBUG" -eq 1 ]; then
        echo "on"
    else
        echo "off"
    fi
}

# Check if debug is enabled
function caddie_debug_is_enabled() {
    [ "$CADDIE_DEBUG" -eq 1 ]
}

# Function to output debug messages (only when debug is enabled)
function caddie_debug() {
    local message="$1"
    
    if caddie_debug_is_enabled; then
        # Always write debug output to stderr
        printf "DEBUG: %s\n" "$message" >&2
    fi
}

# Export functions for external use
export -f caddie_debug_on
export -f caddie_debug_off
export -f caddie_debug_toggle
export -f caddie_debug_status
export -f caddie_debug_is_enabled
export -f caddie_debug

# Export the debug variable
export CADDIE_DEBUG
